-- Siguiendo la estructura existente de la tabla de viajes 2023 proveniente de BA Data, la replico en SQL para trabajarla posteriormente: 

CREATE TABLE viajes_2023 (
    column1 INT,  -- Tipo de dato para column1 (asume INT, puede cambiar según necesidad)
    Id_recorrido INT,  -- Tipo de dato para Id_recorrido (asume INT, puede cambiar según necesidad)
    duracion_recorrido INT,  -- Tipo de dato para duracion_recorrido (asume INT, puede cambiar según necesidad)
    fecha_origen_recorrido DATE,  -- Tipo de dato para fecha_origen_recorrido (asume DATE, puede cambiar según necesidad)
    id_estacion_origen INT,  -- Tipo de dato para id_estacion_origen (asume INT, puede cambiar según necesidad)
    nombre_estacion_origen VARCHAR(255),  -- Tipo de dato para nombre_estacion_origen (asume VARCHAR con longitud suficiente)
    direccion_estacion_origen VARCHAR(255),  -- Tipo de dato para direccion_estacion_origen (asume VARCHAR con longitud suficiente)
    long_estacion_origen DECIMAL(10, 6),  -- Tipo de dato para long_estacion_origen (asume DECIMAL)
    lat_estacion_origen DECIMAL(10, 6),  -- Tipo de dato para lat_estacion_origen (asume DECIMAL)
    fecha_destino_recorrido DATE,  -- Tipo de dato para fecha_destino_recorrido (asume DATE, puede cambiar según necesidad)
    id_estacion_destino INT,  -- Tipo de dato para id_estacion_destino (asume INT, puede cambiar según necesidad)
    nombre_estacion_destino VARCHAR(255),  -- Tipo de dato para nombre_estacion_destino (asume VARCHAR con longitud suficiente)
    direccion_estacion_destino VARCHAR(255),  -- Tipo de dato para direccion_estacion_destino (asume VARCHAR con longitud suficiente)
    long_estacion_destino DECIMAL(10, 6),  -- Tipo de dato para long_estacion_destino (asume DECIMAL)
    lat_estacion_destino DECIMAL(10, 6),  -- Tipo de dato para lat_estacion_destino (asume DECIMAL)
    id_usuario INT,  -- Tipo de dato para id_usuario (asume INT, puede cambiar según necesidad)
    modelo_bici VARCHAR(50),  -- Tipo de dato para modelo_bici (asume VARCHAR con longitud suficiente)
    genero VARCHAR(10)  -- Tipo de dato para género (asume VARCHAR con longitud suficiente)
);

-- Analisis de las combinaciones entre estaciones de origen y destino (en %)

SELECT 
    nombre_estacion_origen,
    nombre_estacion_destino,
    COUNT(*) AS total_trips,
    ROUND((COUNT(*) * 100.0) / SUM(COUNT(*)) OVER(), 2) AS percentage
FROM 
    viajes_2023
GROUP BY 
    nombre_estacion_origen,
    nombre_estacion_destino
ORDER BY 
    percentage DESC;
